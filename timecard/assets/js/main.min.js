function setLocation(e){lat=e.coords.latitude,lon=e.coords.longitude,d=getNowYMDhmsStr(),console.log("lat:"+lat),console.log("lon:"+lon),console.log("d:"+d),document.getElementById("lat").innerHTML=lat,document.getElementById("lon").innerHTML=lon,document.getElementById("date").innerHTML=d;var t={date:d,lat:lat,lon:lon},o=JSON.stringify(t);console.log("json_text:"+o),xhr=new XMLHttpRequest,xhr.onload=function(){var e=xhr.responseText;e.length>0&&(console.log(e),document.getElementById("result").innerHTML=e)},xhr.onerror=function(){alert("error!")},xhr.open("post","api/",!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.send(o)}function showErr(e){switch(e.code){case 1:alert("位置情報の利用が許可されていません");break;case 2:alert("デバイスの位置が判定できません");break;case 3:alert("タイムアウトしました");break;default:alert(e.message)}}function postApi(){if("geolocation"in navigator){navigator.geolocation.getCurrentPosition(setLocation,showErr,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}else alert("ブラウザが位置情報取得に対応していません")}function getNowYMDhmsStr(){const e=new Date;return e.getFullYear()+"/"+("00"+(e.getMonth()+1)).slice(-2)+"/"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2)}document.getElementById("check").onclick=function(){postApi()};
