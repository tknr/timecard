function showResult(e,t=!1){var o=document.getElementById("result");t?o.classList.add("alert"):o.classList.remove("alert"),o.innerHTML=e}function setLocation(e){lat=e.coords.latitude,lon=e.coords.longitude,d=getNowYMDhmsStr(),console.log("lat:"+lat),console.log("lon:"+lon),console.log("d:"+d),document.getElementById("lat").innerHTML=lat,document.getElementById("lon").innerHTML=lon,document.getElementById("date").innerHTML=d;var t={date:d,lat:lat,lon:lon},o=JSON.stringify(t);console.log("json_text:"+o),xhr=new XMLHttpRequest,xhr.onload=function(){var e=xhr.responseText;e.length>0&&showResult(e)},xhr.onerror=function(){showResult("error!",!0)},xhr.open("post","api/",!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.send(o)}function showErr(e){switch(e.code){case 1:showResult("位置情報の利用が許可されていません",!0);break;case 2:showResult("デバイスの位置が判定できません",!0);break;case 3:showResult("タイムアウトしました",!0);break;default:showResult(e.message)}}function postApi(){if("geolocation"in navigator){navigator.geolocation.getCurrentPosition(setLocation,showErr,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}else showResult("ブラウザが位置情報取得に対応していません",!0)}function getNowYMDhmsStr(){const e=new Date;return e.getFullYear()+"/"+("00"+(e.getMonth()+1)).slice(-2)+"/"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2)}document.getElementById("check").onclick=function(){postApi()};
